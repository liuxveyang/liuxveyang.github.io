<!DOCTYPE html>
<html lang="zh-cn">
	<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="liuxueyang">
<meta name="description" content="舊博客">
<meta name="generator" content="Hugo 0.48" />
<title>NFA2DFA</title>
<link rel="shortcut icon" href="https://liuxveyang.github.io/images/favicon.ico">
<link rel="stylesheet" href="https://liuxveyang.github.io/css/style.css">
<link rel="stylesheet" href="https://liuxveyang.github.io/css/highlight.css">



<link rel="stylesheet" href="https://liuxveyang.github.io/css/monosocialiconsfont.css">



<link href="https://liuxveyang.github.io/index.xml" rel="alternate" type="application/rss+xml" title="LXY Site" />


<meta property="og:title" content="NFA2DFA" />
<meta property="og:description" content="input: number of symbols symbol set(each space between two symbol) number of states(state number starts from 1 to n by default) start state number number of accept states accept states set state transfer table (epsilon transfer is at column one and if there are several epsilon transfers, seperate them with a comma without spaces) The following file is the input file." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://liuxveyang.github.io/posts/nfa2dfa/" /><meta property="article:published_time" content="2014-05-28T14:01:53&#43;00:00"/>
<meta property="article:modified_time" content="2014-05-28T14:01:53&#43;00:00"/>


<meta itemprop="name" content="NFA2DFA">
<meta itemprop="description" content="input: number of symbols symbol set(each space between two symbol) number of states(state number starts from 1 to n by default) start state number number of accept states accept states set state transfer table (epsilon transfer is at column one and if there are several epsilon transfers, seperate them with a comma without spaces) The following file is the input file.">


<meta itemprop="datePublished" content="2014-05-28T14:01:53&#43;00:00" />
<meta itemprop="dateModified" content="2014-05-28T14:01:53&#43;00:00" />
<meta itemprop="wordCount" content="1620">



<meta itemprop="keywords" content="c&#43;&#43;," />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="NFA2DFA"/>
<meta name="twitter:description" content="input: number of symbols symbol set(each space between two symbol) number of states(state number starts from 1 to n by default) start state number number of accept states accept states set state transfer table (epsilon transfer is at column one and if there are several epsilon transfers, seperate them with a comma without spaces) The following file is the input file."/>


    </head>
<body>
    <nav class="main-nav">
	
		<a href='https://liuxveyang.github.io'> <span class="arrow">←</span>Home</a>
	

	

	
		<a class="cta" href="https://liuxveyang.github.io/index.xml">Subscribe</a>
	
</nav>

    <section id="wrapper">
        
        
<article class="post">
    <header>
        <h1>NFA2DFA</h1>
        <h2 class="subtitle"></h2>
        <h2 class="headline">
        May 28, 2014
        <br>
        
        
            
                <a href="https://liuxveyang.github.io/tags/c&#43;&#43;">c&#43;&#43;</a>
            
        
        
        </h2>
    </header>
    <section id="post-body">
        <p>input:
number of symbols
symbol set(each space between two symbol)
number of states(state number starts from 1 to n by default)
start state number
number of accept states
accept states set
state transfer table (epsilon transfer is at column one and if there are several epsilon transfers, seperate them with a comma without spaces)
The following file is the input file.</p>

<pre><code class="language-text">	NFA2DFA.txt

	2
	a b
	4
	1
	1
	3
	3 2 1
	-1 1 -1
	-1 3 4
	-1 -1 3

</code></pre>

<p>we input a integer N by str.txt file. then we generate accepted strings by DFA and NFA whose length is no more than N. Then compare those strings generated by NFA and DFA are all the same. The output is in str_out.txt</p>

<p>The following program is the main program.</p>

<pre><code class="language-c++">
/*
 * =====================================================================================
 *       Filename : NFA2DFA.cpp
 *    Description : 
 *    Version     : 0.1
 *        Created : 05/13/14 20:43
 *         Author : Liu Xue Yang (LXY), liuxueyang457@163.com
 *         Motto  : How about today?
 * =====================================================================================
 */
#include &lt;cstdio&gt;
#include &lt;map&gt;
#include &lt;cstdlib&gt;
#include &lt;iostream&gt;
#include &lt;cstring&gt;
#include &lt;set&gt;
#include &lt;vector&gt;
#include &lt;iomanip&gt;
#include &lt;cctype&gt;
#include &lt;string&gt;
#include &lt;stack&gt;
#include &lt;algorithm&gt;

using namespace std;

int trans[1000][1000];
int n;                                          /* number of symbols */
char ch[1000];                                  /* symbol set */
int start_state;                                /* start state */
int n_state;                                    /* number of states */
int nac_state;                                  /* number of accept states */
int ac[1000];                                   /* accept states */
char input[1000];                               /* input string */
int start = 1;                                  /* start state */
bool flag = true;                               /* whether the string is legal */
bool mark_ac;                                   /* whether the string is accepted */
int N;
vector&lt;int&gt; dfa_ac;
vector&lt;vector&lt;int&gt; &gt; e_s;
void dfs_nfa(string, int);
void dfs_dfa(string, int);
bool ac_check(int);
bool ac_check_dfa(int);
bool all_check(int);
vector&lt;vector&lt;int&gt; &gt; Newtrans;
vector&lt;string&gt; dfa_generate, nfa_generate;

/* 
 * ===  FUNCTION  ======================================================================
 *         Name: main
 * =====================================================================================
 */

	int
main ( int argc, char *argv[] )
{

	freopen(&quot;NFA2DFA.txt&quot;, &quot;r&quot;, stdin);

	dfa_ac.clear();
	scanf ( &quot;%d&quot;, &amp;n);
	getchar();
	for ( int i = 0; i &lt; n; ++i ) {
		scanf ( &quot;%c&quot;, &amp;ch[i] );
		getchar();
	}
	scanf ( &quot;%d%d%d&quot;, &amp;n_state, &amp;start_state, &amp;nac_state );
	for ( int i = 0; i &lt; nac_state; ++i ) {
		scanf ( &quot;%d&quot;, &amp;ac[i] );
	}
	string str;
	e_s.clear();
	char buffer[1111];
	for ( int i = 0; i &lt; n_state; ++i ) {
		cin &gt;&gt; str;
		memset(buffer, 0, sizeof(buffer));
		strcpy(buffer, str.c_str());
		char *pch = strtok(buffer, &quot;,&quot;);
		char suffer[1000];
		vector&lt;int&gt; t_a;
		t_a.clear();
		while ( NULL != pch ) {
			memset(suffer, 0, sizeof(suffer));
			strcpy(suffer, pch);
			int su_n = atoi(suffer);
			t_a.push_back(su_n);
			pch = strtok(NULL, &quot;,&quot;);
		}
		e_s.push_back(t_a);
		for ( int j = 1; j &lt; n + 1; ++j ) {
			scanf ( &quot;%d&quot;, &amp;trans[i][j] );
		}
	}
	vector&lt;int&gt;::iterator i_t;
	vector&lt;int&gt; v;

	map&lt;vector&lt;int&gt;, int &gt; mystate;
	mystate.clear();

	Newtrans.clear();

	int ii;
	ii = 0;
	set&lt;int&gt; s_in;
	s_in.clear();
	v.push_back(start_state);
	s_in.insert(start_state);
	// start_state enclosure
	for ( i_t = e_s[start_state-1].begin(); i_t != e_s[start_state-1].end(); ++i_t ) {
		if ( -1 != *i_t &amp;&amp; s_in.count(*i_t) == 0) {
			v.push_back(*i_t);
			s_in.insert(*i_t);
		}
	}
	vector&lt;int&gt;::iterator it;
	bool in_ac = false;
	for ( it = v.begin(); it != v.end(); ++it ) {
		for ( int jk = 0; jk &lt; nac_state; ++jk ) {
			if ( ac[jk] == (*it) ) {
				in_ac = true;
				dfa_ac.push_back(0);
				break;
			}
		}
		if ( in_ac ) {
			break;
		}
	}
	sort(v.begin(), v.end());

	vector&lt;int&gt; add;
	add.clear();

	mystate.insert(pair&lt;vector&lt;int&gt;, int&gt;(v, ii));
	++ii;
	Newtrans.push_back(add);                      /* push_back a empty vector */

	stack&lt;vector&lt;int&gt; &gt; stac;
	stac.push(v);
	while ( !stac.empty() ) {                     /*if stack if not empty we will search new state */
		vector&lt;int&gt; tmp;
		v = stac.top();
		stac.pop();
		int jj;
		jj = mystate[v];
		for ( int i = 1; i &lt; n + 1; ++i ) {         /* for every symbol */
			tmp.clear();
			s_in.clear();
			// move(v, i) = tmp
			for ( it = v.begin(); it != v.end(); ++it ) { /* for every symbol in this set (this symbol as input) */
				if (-1 != trans[(*it)-1][i] &amp;&amp; s_in.count(trans[(*it)-1][i]) == 0) { /* we can not push_back -1!!!f**k!!! */
					tmp.push_back(trans[(*it)-1][i]);     /* =_= T_T I wasted so much time to debug here!!!!!! T^T */
					s_in.insert(trans[(*it)-1][i]);
				}
			}
			// get enclosure tmp-enclosure
			vector&lt;int&gt; tmp_i;
			tmp_i = tmp;
			for ( it = tmp.begin(); it != tmp.end(); ++it ) { /* get stuck!!! command terminated */
				for ( i_t = e_s[(*it)-1].begin(); i_t != e_s[(*it)-1].end(); ++i_t ) {
					if ( -1 != *i_t &amp;&amp; s_in.count(*i_t) == 0 ) {
						tmp_i.push_back(*i_t);              /* we cannot modify tmp */
						s_in.insert(*i_t);
					}
				}
			}
			tmp = tmp_i;
			sort(tmp.begin(), tmp.end());
			if ( (tmp.size() != 0) &amp;&amp; !mystate.count(tmp)) {                  /* do not have it */
				mystate.insert(pair&lt;vector&lt;int&gt;, int&gt;(tmp, ii));
				in_ac = false;
				for ( it = tmp.begin(); it != tmp.end(); ++it ) {
					for ( int jk = 0; jk &lt; nac_state; ++jk ) {
						if ( ac[jk] == (*it) ) {
							in_ac = true;
							dfa_ac.push_back(ii);
							break;
						}
					}
					if ( in_ac ) {
						break;
					}
				}
				add.clear();
				Newtrans.push_back(add);
				ii++;
				stac.push(tmp);
			}
			if (tmp.size() != 0) {
				Newtrans[jj].push_back(mystate[tmp]);
			}
			else {
				Newtrans[jj].push_back(-1);
			}
		}
	}
//	vector&lt;vector&lt;int&gt; &gt;::iterator j_t;
//	for ( j_t = Newtrans.begin(); j_t != Newtrans.end(); ++j_t ) {
//		for ( it = (*j_t).begin(); it != (*j_t).end(); ++it ) {
//			cout &lt;&lt; *it &lt;&lt; &quot; &quot;;
//		}
//		cout &lt;&lt; endl;
//	}
	// succeed!
	// Out put DFA!
	for (int i = 0; i &lt; ii; ++i) {
		for ( it = Newtrans[i].begin(); it != Newtrans[i].end(); ++it ) {
			cout &lt;&lt; *it &lt;&lt; &quot; &quot;;
		}
		cout &lt;&lt; endl;
	}
	// output accepted state
	cout &lt;&lt; &quot;accepted state: &quot;; 
	for ( it = dfa_ac.begin(); it != dfa_ac.end() ; ++it ) {
		cout &lt;&lt; *it &lt;&lt; &quot; &quot;; 
	}
	N = 3;
	dfa_generate.clear();
	nfa_generate.clear();
//	printf ( &quot;\n&quot; );
	freopen(&quot;str.txt&quot;, &quot;r&quot;, stdin);
	freopen(&quot;str_out.txt&quot;, &quot;w&quot;, stdout);
	while ( ~scanf(&quot;%d&quot;, &amp;N) ) {
		string sad = &quot;&quot;;
		dfs_dfa(sad, 0);
		sort(dfa_generate.begin(), dfa_generate.end());
		vector&lt;string&gt;::iterator end_u, sadbu;
		end_u = unique(dfa_generate.begin(), dfa_generate.end());
		dfa_generate.erase(end_u, dfa_generate.end());
		cout &lt;&lt; &quot;********************&quot; &lt;&lt; endl; 
		cout &lt;&lt; &quot;size = &quot; &lt;&lt; dfa_generate.size() &lt;&lt; endl; 
		for ( sadbu = dfa_generate.begin(); sadbu != dfa_generate.end(); ++sadbu ) {
			cout &lt;&lt; *sadbu &lt;&lt; endl;
		}
		sad = &quot;&quot;;
		dfs_nfa(sad, 1);
		sort(nfa_generate.begin(), nfa_generate.end());
		end_u = unique(nfa_generate.begin(), nfa_generate.end());
		nfa_generate.erase(end_u, nfa_generate.end());
		cout &lt;&lt; &quot;********************&quot; &lt;&lt; endl; 
		cout &lt;&lt; &quot;size = &quot; &lt;&lt; nfa_generate.size() &lt;&lt; endl; 
		for ( sadbu = nfa_generate.begin(); sadbu != nfa_generate.end(); ++sadbu ) {
			cout &lt;&lt; *sadbu &lt;&lt; endl;
		}
		bool mark = true;
		if ( dfa_generate.size() != nfa_generate.size() ) {
			mark = false;
			printf ( &quot;size is Different!\n&quot; );
		} else {
			for ( int js = 0; js &lt; dfa_generate.size(); ++js ) {
				if ( dfa_generate[js] != nfa_generate[js] ) {
					mark = false;
					break;
				}
			}
		}
		if ( mark ) {
			cout &lt;&lt; &quot;Same!&quot; &lt;&lt; endl; 
		} 
		else {
			cout &lt;&lt; &quot;Different!&quot; &lt;&lt; endl;
		}
	}

		return EXIT_SUCCESS;
}				/* ----------  end of function main  ---------- */

/* 
 * ===  FUNCTION  ======================================================================
 *         Name:  dfs_dfa
 *  Description:  dfs to generate string
 * =====================================================================================
 */
	void
dfs_dfa ( string str, int now )
{
	int len = str.length();
	if ( len &gt; N ) {
		return;
	}
	if ( len &gt; 0 &amp;&amp; len &lt;= N &amp;&amp; ac_check_dfa(now) ) {
		dfa_generate.push_back(str);
//		cout &lt;&lt; str &lt;&lt; endl;
	}
	vector&lt;int&gt;::iterator jk;
	for ( jk = Newtrans[now].begin(); jk != Newtrans[now].end(); ++jk ) {
		if ( -1 != *jk ) {
			dfs_dfa(str + ch[jk-Newtrans[now].begin()], *jk);
		}
	}
	return ;
}		/* -----  end of function dfs_dfa  ----- */

/* 
 * ===  FUNCTION  ======================================================================
 *         Name:  dfs_nfa
 *  Description:  dfs to generate string
 * =====================================================================================
 */
	void
dfs_nfa ( string str, int now )
{
	int len = str.length();
	if ( len &gt; N ) {
		return;
	}
	if ( len &gt; 0 &amp;&amp; len &lt;= N &amp;&amp; all_check(now) ) {
		nfa_generate.push_back(str);
//		cout &lt;&lt; str &lt;&lt; endl;
	}
	for ( int i = 1; i &lt; n + 1; ++i ) {
		if ( -1 != trans[now-1][i] ) {
			dfs_nfa(str+ch[i-1], trans[now-1][i]);
		}
	}
	vector&lt;int&gt;::iterator i_t;
	for ( i_t = e_s[now-1].begin(); i_t != e_s[now-1].end(); ++i_t ) {
		if ( -1 != *i_t ) {
			dfs_nfa(str, *i_t);
		}
		else break;
	}
	return ;
}		/* -----  end of function dfs_nfa  ----- */

/* 
 * ===  FUNCTION  ======================================================================
 *         Name:  all_check
 *  Description:  enclosure check
 * =====================================================================================
 */
	bool
all_check ( int sta )
{
	bool mark = false;
	mark = ac_check(sta);
	if ( mark ) {
		return mark;
	}
//	vector&lt;int&gt;::iterator i_t;
//	for ( i_t = e_s[sta-1].begin(); i_t != e_s[sta-1].end(); ++i_t ) {
//		if ( -1 != *i_t ) {
//			mark = ac_check(*i_t);
//			if ( mark ) {
//				break;
//			}
//		}
//		else break;
//	}
	return mark;
}		/* -----  end of function all_check  ----- */

/* 
 * ===  FUNCTION  ======================================================================
 *         Name:  ac_check
 *  Description:  check whether a state is accepted
 * =====================================================================================
 */
	bool
ac_check ( int sta )
{
	bool mark = false;
	for ( int i = 0; i &lt; nac_state; ++i ) {
		if ( sta == ac[i] ) {
			mark = true;
			break;
		}
	}
	return mark;
}		/* -----  end of function ac_check  ----- */

/* 
 * ===  FUNCTION  ======================================================================
 *         Name:  ac_check_dfa
 *  Description:  check whether it is legal
 * =====================================================================================
 */
	bool
ac_check_dfa ( int sta )
{
	bool mark = false;
	vector&lt;int&gt;::iterator it;
	for ( it = dfa_ac.begin(); it != dfa_ac.end(); ++it ) {
		if ( (*it) == sta ) {
			mark = true;
			return mark;
		}
	}
	return mark;
}		/* -----  end of function ac_check_dfa  ----- */
</code></pre>

<p>Nice.</p>

<hr />

<p>Maybe I made a mistake! I forget a case:
when I get epsilon of a node, it may have some consistent epsilon transfers! So I should use dfs to get the whole epsilon!</p>

<p>I find this problem when I read this blog: <a href="www.cnblgos.com/cyjb/archive/LexerDfa.html">cyjb</a>
Thank You!
I will fix the problem later.</p>

    </section>
</article>

<footer id="post-meta" class="clearfix">
    
    <img class="avatar" src="https://liuxveyang.github.io/images/avatar.png">
    <div>
        <span class="dark">liuxueyang</span>
        <span>I am a learner. :P</span>
    </div>
    
    <section id="sharing">
        <a class="twitter" href="https://twitter.com/intent/tweet?text=https%3a%2f%2fliuxveyang.github.io%2fposts%2fnfa2dfa%2f - NFA2DFA "><span class="icon-twitter"> tweet</span></a>

<a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;"><span class="icon-facebook-rect"> Share</span>
</a>

    </section>
</footer>

<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "liuxveyang" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

<ul id="post-list" class="archive readmore">
    <h3>Read more</h3>

    
    
    
        <li>
            <a href="/posts/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B06%E6%8A%80%E6%9C%AF%E7%B1%BB/">读书笔记6「技术类」<aside class="dates">May 14 2018</aside></a>
        </li>
    
        <li>
            <a href="/posts/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B05/">读书笔记5<aside class="dates">Apr 29 2018</aside></a>
        </li>
    
        <li>
            <a href="/posts/%E6%95%B4%E7%90%86%E5%8D%9A%E5%AE%A2/">整理博客<aside class="dates">Apr 29 2018</aside></a>
        </li>
    
        <li>
            <a href="/posts/2017-12-23-summary-for-2017/">2017 年结束了<aside class="dates">Dec 23 2017</aside></a>
        </li>
    
        <li>
            <a href="/posts/clustering/">Clustering<aside class="dates">May 17 2017</aside></a>
        </li>
    
        <li>
            <a href="/posts/building-roads-to-connect-cities/">Building Roads to Connect Cities<aside class="dates">May 17 2017</aside></a>
        </li>
    
        <li>
            <a href="/posts/detecting-anomalies-in-currency-exchange-rates/">Detecting Anomalies in Currency Exchange Rates<aside class="dates">May 17 2017</aside></a>
        </li>
    
        <li>
            <a href="/posts/computing-minimum-cost-of-a-flight/">Computing the Minimum Cost of a Flight<aside class="dates">May 17 2017</aside></a>
        </li>
    
        <li>
            <a href="/posts/checking-whether-a-graph-is-bipartite/">Checking whether a Graph is Bipartite<aside class="dates">May 17 2017</aside></a>
        </li>
    
        <li>
            <a href="/posts/computing-minimum-number-of-flight-segments/">Computing the Minimum Number of Flight Segments<aside class="dates">May 16 2017</aside></a>
        </li>
    
</ul>



        <footer id="footer">
    
        <div id="social">

	
	
    
    <a class="symbol" href="https://www.github.com/liuxueyang">
        circlegithub
    </a>
    


</div>

    
    <p class="small">
    
        © Copyright 2018 liuxueyang
    
    </p>
</footer>

    </section>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://liuxveyang.github.io/js/main.js"></script>
<script src="https://liuxveyang.github.io/js/highlight.js"></script>
<script>hljs.initHighlightingOnLoad();</script>




<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-125224924-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


</body>
</html>
